---
import type { GetStaticPaths } from "astro";
import type { BlogEntry } from "@/types";
import { sortByDate } from "@lib/sortFunctions";
import EntryLayout from "@components/blog/EntryLayout.astro";
import { getEntries } from "@lib/contentParser";
import similerItems from "@lib/similarItems";

export async function getStaticPaths() {
  const lang = "en";
  const entries = (await getEntries("blog", "en", sortByDate)) as BlogEntry[];
  const paths = entries.map((entry) => {
    // Extraer el slug de la entrada (sin el prefijo de idioma)
    const entrySlug = entry.id.split("/").slice(2).join("/");

    return {
      params: {
        entry: entrySlug, // Usar solo el slug sin el prefijo de idioma
      },
      props: { entry, entries },
    };
  });
  return paths;
}

const { entry, entries } = Astro.props;
const relatedEntries = similerItems(entry, entries, entry.id);
---

<EntryLayout entry={entry} relatedEntries={relatedEntries} />
