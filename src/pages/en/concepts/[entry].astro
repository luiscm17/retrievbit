---
import type { ConceptsEntry } from "@/types";
import { sortByDate } from "@lib/sortFunctions";
import EntryLayout from "@components/concepts/EntryLayout.astro";
import { getEntries } from "@lib/contentParser";

const lang = "en";

export async function getStaticPaths() {
  const lang = "en";
  const entries = (await getEntries("concepts", lang, sortByDate)) as ConceptsEntry[];
  const pageIDs: string[] = entries.map((entry) => entry.id);
  const pageCount = pageIDs.length;

  const paths = entries.map((entry) => {
    const pageIndex = pageIDs.indexOf(entry.id);
    // Extraer solo el slug de la entrada sin el prefijo de idioma
    const slug = entry.id.split("/").pop();
    return {
      params: {
        entry: slug,
      },
      props: { entry, pageIDs, pageIndex, pageCount },
    };
  });
  return paths;
}

const { entry, pageIDs, pageIndex, pageCount } = Astro.props;
---

<EntryLayout entry={entry} pageIDs={pageIDs} pageIndex={pageIndex} pageCount={pageCount} />
